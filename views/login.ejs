<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>login</title>
    <link rel="stylesheet" href="css/anime.css">
    <link rel="stylesheet" href="css/index.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <style>
        .autocomplete-suggestions-faculty {
         width: 100%;
          border: 1px solid #ddd;
          max-height: 150px;
          overflow-y: auto;
          background-color: #fff;
          position: absolute;
          z-index: 9999;
          display: none; /* เริ่มต้นซ่อน */
      }
      .autocomplete-suggestion-faculty {
          padding: 10px;
          cursor: pointer;
      }
      .autocomplete-suggestion-faculty:hover {
          background-color: #f0f0f0;
      }
      .autocomplete-suggestions {
         width: 100%;
          border: 1px solid #ddd;
          max-height: 150px;
          overflow-y: auto;
          background-color: #fff;
          position: absolute;
          z-index: 9999;
          display: none; /* เริ่มต้นซ่อน */
      }
      .autocomplete-suggestion {
          padding: 10px;
          cursor: pointer;
      }
      .autocomplete-suggestion:hover {
          background-color: #f0f0f0;
      }
    </style>
</head>
<body>
    <div class="login">
        
        <form id="login-form">
            <h1>login</h1>
            <div class="input-container">
                <input required="" id="username" type="text" name="username"/>
                <label class="label" for="username">Username</label>
                <div class="underline"></div>
            </div>
            <div class="input-container">
                <input required="" id="password" type="password" name="password"/>
                <label class="label" for="password">Password</label>
                <div class="underline"></div>
            </div>
            <button type="submit" id="myButton">Login</button>
        </form>
        
        <script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>
    <script>
        document.getElementById('login-form').addEventListener('submit', async (event) => {
            event.preventDefault();

            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;

            try {
                const response = await fetch('/login', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ username, password })
                });

                const result = await response.json();

                if (response.ok) {
                    localStorage.setItem('token', result.token);
                    Swal.fire({
                        title: 'Login Successful',
                        text: 'You will be redirected to your profile.',
                        icon: 'success',
                        confirmButtonText: 'OK'
                    }).then((result) => {
                        if (result.isConfirmed) {
                            window.location.href = '/myprofile';
                        }
                    });
                } else {
                    Swal.fire({
                        title: 'Login Failed',
                        text: result.message,
                        icon: 'error',
                        confirmButtonText: 'Try Again'
                    });
                }
            } catch (error) {
                Swal.fire({
                    title: 'Error',
                    text: 'Something went wrong. Please try again.',
                    icon: 'error',
                    confirmButtonText: 'OK'
                });
            }
        });
    </script>
        
        
</body>
</html>